<div class="container margin-top-main">
  <h1>All Orders</h1>
  <div class="table-container">
    <table
      mat-table
      [dataSource]="dataSource"
      matSort
      class="mat-elevation-z8"
    >
      <!-- Order ID Column -->
      <ng-container matColumnDef="order_id">
        <th
          mat-header-cell
          *matHeaderCellDef
          mat-sort-header
        >
          Order ID
        </th>
        <td
          mat-cell
          *matCellDef="let order"
        >
          {{ order.order_id }}
        </td>
      </ng-container>

      <!-- Order Date Column -->
      <ng-container matColumnDef="date_time">
        <th
          mat-header-cell
          *matHeaderCellDef
          mat-sort-header
        >
          Order Date
        </th>
        <td
          mat-cell
          *matCellDef="let order"
        >
          {{ order.datetimeStr }}
        </td>
      </ng-container>

      <!-- Customer Username Column -->
      <ng-container matColumnDef="username">
        <th
          mat-header-cell
          *matHeaderCellDef
          mat-sort-header
        >
          Username
        </th>
        <td
          mat-cell
          *matCellDef="let order"
        >
          {{ order.customer.username }}
        </td>
      </ng-container>

      <!-- Restaurant Name Column -->
      <ng-container matColumnDef="restaurant_name">
        <th
          mat-header-cell
          *matHeaderCellDef
          mat-sort-header
        >
          Restaurant Name
        </th>
        <td
          mat-cell
          *matCellDef="let order"
        >
          {{ order.restaurant_name }}
        </td>
      </ng-container>

      <!-- Total Price Column -->
      <ng-container matColumnDef="total_price">
        <th
          mat-header-cell
          *matHeaderCellDef
          mat-sort-header
        >
          Total Price
        </th>
        <td
          mat-cell
          *matCellDef="let order"
        >
          {{ order.total_price }}
        </td>
      </ng-container>

      <!-- Status Column -->
      <ng-container matColumnDef="status">
        <th
          mat-header-cell
          *matHeaderCellDef
          mat-sort-header
        >
          Status
        </th>
        <td
          mat-cell
          *matCellDef="let order"
        >
          {{ order.status }}
        </td>
      </ng-container>

      <!-- Actions Column -->
      <ng-container matColumnDef="actions">
        <th
          mat-header-cell
          *matHeaderCellDef
        >
          Actions
        </th>
        <td
          mat-cell
          *matCellDef="let order"
        >
          <ng-container *ngIf="order.status === 'SUBMITTED'">
            <button
              class="btn btn--primary"
              (click)="approveOrder(order.order_id)"
            >
              Approve
            </button>
            <button
              class="btn btn--secondary"
              (click)="rejectOrder(order.order_id)"
            >
              Cancel
            </button>
          </ng-container>
        </td>
      </ng-container>

      <tr
        mat-header-row
        *matHeaderRowDef="['order_id', 'date_time', 'username', 'restaurant_name', 'total_price', 'status', 'actions']"
      ></tr>
      <tr
        mat-row
        *matRowDef="let row; columns: ['order_id', 'date_time', 'username', 'restaurant_name', 'total_price', 'status', 'actions']"
      ></tr>
    </table>
  </div>
</div>
